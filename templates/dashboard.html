<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>DogAI Vet â€“ Decode Your Dog with AI</title>

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

    <!-- Google Font -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">

    <style>
        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, #f5f7fa, #e2ebf0);
            min-height: 100vh;
        }

        .navbar {
            background: linear-gradient(90deg, #4f46e5, #0ea5e9);
        }

        .hero-card {
            background: linear-gradient(135deg, #6366f1, #0ea5e9);
            color: white;
            border: none;
        }

        .hero-card h1 span {
            color: #fde047;
        }

        .upload-box {
            border: 2px dashed #c7d2fe;
            padding: 30px;
            border-radius: 16px;
            background: #f8fafc;
        }

        .ask-card {
            background: #ffffff;
            border-radius: 18px;
        }

        .glow-btn {
            background: linear-gradient(90deg, #22c55e, #4ade80);
            border: none;
            color: white;
            font-weight: 600;
        }

        .glow-btn:hover {
            box-shadow: 0 0 20px rgba(34,197,94,0.5);
            transform: translateY(-1px);
        }

        .answer-box {
            background: #f1f5f9;
            border-radius: 12px;
            padding: 15px;
        }

        .badge-ai {
            background: #0ea5e9;
        }
    </style>
</head>

<body>

<!-- NAVBAR -->
<nav class="navbar navbar-expand-lg navbar-dark shadow">
    <div class="container">
        <a class="navbar-brand fw-bold fs-4" href="/">ğŸ¶ DogAI Vet</a>
        <span class="badge badge-ai">AI Powered</span>
    </div>
</nav>

<div class="container py-5">

    <!-- HERO -->
    <div class="card hero-card shadow-lg mb-5">
        <div class="card-body text-center py-5">
            <h1 class="fw-bold display-6 mb-3">Decode Your Dog with <span>AI</span> ğŸ§ ğŸ•</h1>
            <p class="lead mb-0">Turning dog behavior into real health insights. Smart. Simple. Powerful.</p>
        </div>
    </div>

    <!-- UPLOAD SECTION -->
    <div class="card shadow-sm mb-5">
        <div class="card-body text-center">
            <h3 class="fw-bold mb-2">ğŸ“¹ Upload Your Dogâ€™s Video</h3>
            <p class="text-muted">Let AI read posture, movement & behavior like a pro vet.</p>

            <div class="upload-box mt-3">
                <form action="{{ url_for('upload') }}" method="POST" enctype="multipart/form-data">
                    <input type="file" name="video" class="form-control mb-3" required>
                    <button type="submit" class="btn btn-primary btn-lg px-5">Analyze Now âš¡</button>
                </form>
            </div>
        </div>
    </div>

    <!-- ASK AI SECTION -->
    <div class="card ask-card shadow-lg">
        <div class="card-body">
            <h3 class="fw-bold mb-1">Whatâ€™s Your Dog Trying to Say? ğŸ¾</h3>
            <p class="text-muted mb-3">Drop your question. Our AI reads between the barks.</p>

            <textarea id="questionInput" class="form-control mb-3" rows="4"
                placeholder="e.g. My dog is acting weird latelyâ€¦ should I be worried?"></textarea>

            <button onclick="askQuestion()" class="btn glow-btn px-4 py-2">Ask AI ğŸ”®</button>

            <!-- Loading -->
            <div id="loadingSpinner" class="text-center mt-4" style="display:none;">
                <div class="spinner-border text-primary" role="status"></div>
                <p class="mt-2 fw-semibold">Thinking like a vetâ€¦ ğŸ§‘â€âš•ï¸</p>
            </div>

            <!-- Answer -->
            <div id="answerBox" class="answer-box mt-4" style="display:none;">
                <h6 class="fw-bold mb-2">AI Insight</h6>
                <p id="answerText" class="mb-0"></p>
            </div>

            <!-- Error -->
            <div id="errorBox" class="alert alert-danger mt-4" style="display:none;">
                <strong>Oops:</strong> <span id="errorText"></span>
            </div>
        </div>
    </div>

</div>

<!-- Bootstrap JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

<script>
function askQuestion() {
    const question = document.getElementById("questionInput").value.trim();
    const answerBox = document.getElementById("answerBox");
    const answerText = document.getElementById("answerText");
    const errorBox = document.getElementById("errorBox");
    const errorText = document.getElementById("errorText");
    const spinner = document.getElementById("loadingSpinner");

    answerBox.style.display = "none";
    errorBox.style.display = "none";

    if (!question) {
        errorBox.style.display = "block";
        errorText.innerText = "Type something about your dog first ğŸ¶";
        return;
    }

    spinner.style.display = "block";

    fetch("/get_answer", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ question: question })
    })
    .then(res => res.json())
    .then(data => {
        spinner.style.display = "none";

        if (!data.answer || data.answer.toLowerCase().includes("no relevant")) {
            errorBox.style.display = "block";
            errorText.innerText = "AI couldnâ€™t find muchâ€¦ try rephrasing your question.";
        } else {
            answerBox.style.display = "block";
            answerText.innerText = data.answer;
        }
    })
    .catch(err => {
        spinner.style.display = "none";
        errorBox.style.display = "block";
        errorText.innerText = "Something went wrong. Try again.";
        console.error(err);
    });
}
</script>

</body>
</html>
